<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="../customElements/head-element.js"></script>
    <custom-head
      page-title="Support - POStore"
      description="Get help and support for your POStore purchases. Find troubleshooting guides, return instructions, and contact our support team."
      keywords="support, help, customer service, troubleshooting, returns, POStore"
      author="POStore Team"
      favicon-url="../assets/favicon.ico"
      stylesheets="../css/style.css"
    ></custom-head>
    <!-- Section Loader JS -->
    <script src="../js/section-loader.js"></script>
    <script defer>
      // Load sections when the page is ready
      document.addEventListener("DOMContentLoaded", function () {
        // Load header section
        loadSection("headerSection", "../sections/header.html", "../");
        // Load footer section
        loadSection("footerSection", "../sections/footer.html", "../");
        loadSection(
          "cartComponentsSection",
          "../sections/cart-components.html"
        );
      });
    </script>
  </head>
  <body>
    <!-- Header Section -->
    <div id="headerSection"></div>

    <!-- Page Header -->
    <section class="bg-primary text-white py-5 mt-5">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-8">
            <h1 class="display-4 fw-bold">Customer Support</h1>
            <p class="lead">
              We're here to help with any issues or questions you may have.
            </p>
          </div>
          <div class="col-lg-4 text-lg-end">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb justify-content-lg-end mb-0">
                <li class="breadcrumb-item">
                  <a href="../index.html" class="text-white">Home</a>
                </li>
                <li
                  class="breadcrumb-item active text-white"
                  aria-current="page"
                >
                  Support
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </section>

    <!-- Support Options -->
    <section class="py-5">
      <div class="container">
        <div class="row g-4">
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body text-center p-4">
                <div class="feature-icon bg-primary text-white mb-4">
                  <i class="bi bi-envelope fs-2"></i>
                </div>
                <h3 class="h4 mb-3">Email Support</h3>
                <p class="text-muted mb-4">
                  Send us an email and we'll get back to you within 24 hours.
                </p>
                <a href="contact.html" class="btn btn-outline-primary"
                  >Contact Form</a
                >
                <p id="business-email" class="small text-muted mt-2">
                  support@postore.com
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-body text-center p-4">
                <div class="feature-icon bg-primary text-white mb-4">
                  <i class="bi bi-telephone fs-2"></i>
                </div>
                <h3 class="h4 mb-3">Phone Support</h3>
                <p class="text-muted mb-4">
                  Call us directly for urgent matters or complex issues.
                </p>
                <a
                  href="tel:+18001234567"
                  id="business-phone"
                  class="btn btn-outline-primary"
                  >+1 (800) 123-4567</a
                >
                <p class="small text-muted mt-2">Mon-Fri: 9am-6pm EST</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Common Issues -->
    <section class="py-5 bg-light">
      <div class="container">
        <div class="text-center mb-5">
          <h2 class="display-5 fw-bold">Common Issues</h2>
          <p class="lead text-muted">
            Quick solutions to frequently encountered problems
          </p>
        </div>
        <div class="row">
          <div class="col-12">
            <ul
              class="nav nav-pills mb-4 justify-content-center"
              id="issuesTab"
              role="tablist"
            >
              <li class="nav-item mx-2" role="presentation">
                <button
                  class="active btn btn-primary"
                  id="orders-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#orders"
                  type="button"
                  role="tab"
                >
                  Order Issues
                </button>
              </li>
              <li class="nav-item mx-2" role="presentation">
                <button
                  class="btn btn-primary"
                  id="returns-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#returns"
                  type="button"
                  role="tab"
                >
                  Returns & Refunds
                </button>
              </li>
              <li class="nav-item mx-2" role="presentation">
                <button
                  class="btn btn-primary"
                  id="payment-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#payment"
                  type="button"
                  role="tab"
                >
                  Payment Issues
                </button>
              </li>
              <!-- <li class="nav-item mx-2" role="presentation">
                <button
                  class="btn btn-primary"
                  id="account-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#account"
                  type="button"
                  role="tab"
                >
                  Account Help
                </button>
              </li> -->
            </ul>
          </div>
        </div>
        <div class="tab-content" id="issuesTabContent">
          <!-- Order Issues -->
          <div class="tab-pane fade show active" id="orders" role="tabpanel">
            <div class="accordion" id="accordionOrders">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#orderOne"
                  >
                    How to track my order
                  </button>
                </h2>
                <div
                  id="orderOne"
                  class="accordion-collapse collapse show"
                  data-bs-parent="#accordionOrders"
                >
                  <div class="accordion-body">
                    Once your order ships, you'll receive a confirmation email
                    with a tracking number. You can use this number to track
                    your package on our website under "Orders" in the main menu
                    or directly through the carrier's website.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#orderTwo"
                  >
                    My order is delayed
                  </button>
                </h2>
                <div
                  id="orderTwo"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionOrders"
                >
                  <div class="accordion-body">
                    Order delays can occur due to high demand, weather
                    conditions, or carrier issues. Please check your tracking
                    information for the most up-to-date status. If your order is
                    significantly delayed, contact our support team.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#orderThree"
                  >
                    I received the wrong item
                  </button>
                </h2>
                <div
                  id="orderThree"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionOrders"
                >
                  <div class="accordion-body">
                    We apologize for the error. Please contact our support team
                    immediately with your order number and photos of the
                    incorrect item. We'll arrange for a return and send you the
                    correct item at no additional cost.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#orderFour"
                  >
                    Item arrived damaged
                  </button>
                </h2>
                <div
                  id="orderFour"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionOrders"
                >
                  <div class="accordion-body">
                    If your item arrived damaged, please take photos of the
                    damage and packaging, then contact our support team within
                    48 hours. We'll process a replacement or refund immediately.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Returns & Refunds -->
          <div class="tab-pane fade" id="returns" role="tabpanel">
            <div class="accordion" id="accordionReturns">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#returnOne"
                  >
                    How to return an item
                  </button>
                </h2>
                <div
                  id="returnOne"
                  class="accordion-collapse collapse show"
                  data-bs-parent="#accordionReturns"
                >
                  <div class="accordion-body">
                    To initiate a return, Contact us for more information. We'll
                    guide you through the return process. Please note that we
                    only accept returns within 30 days of purchase.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#returnTwo"
                  >
                    Return policy information
                  </button>
                </h2>
                <div
                  id="returnTwo"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionReturns"
                >
                  <div class="accordion-body">
                    We offer a 30-day return policy for most items. Products
                    must be in their original condition with all packaging and
                    tags intact. Some categories like electronics may have a
                    15-day return window. Personalized items and certain hygiene
                    products cannot be returned.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#returnThree"
                  >
                    Check refund status
                  </button>
                </h2>
                <div
                  id="returnThree"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionReturns"
                >
                  <div class="accordion-body">
                    Once we receive and inspect your return, refunds are
                    typically processed within 3-5 business days. The time it
                    takes for the refund to appear in your account depends on
                    your payment method and financial institution, usually 5-10
                    business days.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#returnFour"
                  >
                    Exchange an item
                  </button>
                </h2>
                <div
                  id="returnFour"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionReturns"
                >
                  <div class="accordion-body">
                    To exchange an item for a different size or color, please
                    initiate a return for the original item and place a new
                    order for the desired item. This ensures faster processing
                    and availability.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Payment Issues -->
          <div class="tab-pane fade" id="payment" role="tabpanel">
            <div class="accordion" id="accordionPayment">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#paymentOne"
                  >
                    Payment methods accepted
                  </button>
                </h2>
                <div
                  id="paymentOne"
                  class="accordion-collapse collapse show"
                  data-bs-parent="#accordionPayment"
                >
                  <div class="accordion-body">
                    We accept all major credit cards (Visa, Mastercard, American
                    Express, Discover), PayPal, Apple Pay, Google Pay, and Shop
                    Pay. For select high-value purchases, we also offer
                    financing options through Affirm.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#paymentTwo"
                  >
                    My payment was declined
                  </button>
                </h2>
                <div
                  id="paymentTwo"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionPayment"
                >
                  <div class="accordion-body">
                    Payment declines can occur due to insufficient funds,
                    incorrect billing information, or bank security measures.
                    Please verify your payment details and try again. If the
                    issue persists, contact your bank or try a different payment
                    method.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#paymentThree"
                  >
                    I was charged twice
                  </button>
                </h2>
                <div
                  id="paymentThree"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionPayment"
                >
                  <div class="accordion-body">
                    Double charges can occur due to technical issues or multiple
                    submission attempts. Please contact our support team with
                    your order details, and we'll investigate and process a
                    refund for any duplicate charges within 24 hours.
                  </div>
                </div>
              </div>
              <!-- <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#paymentFour">
                    Update payment information
                  </button>
                </h2>
                <div id="paymentFour" class="accordion-collapse collapse" data-bs-parent="#accordionPayment">
                  <div class="accordion-body">
                    You can update your payment information in your account settings under "Payment Methods." For security reasons, we don't store full credit card details, so you'll need to re-enter your card information completely.
                  </div>
                </div>
              </div> -->
            </div>
          </div>

          <!-- Account Help -->
          <!-- <div class="tab-pane fade" id="account" role="tabpanel">
            <div class="accordion" id="accordionAccount">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#accountOne"
                  >
                    Reset my password
                  </button>
                </h2>
                <div
                  id="accountOne"
                  class="accordion-collapse collapse show"
                  data-bs-parent="#accordionAccount"
                >
                  <div class="accordion-body">
                    To reset your password, click "Forgot Password" on the login
                    page and enter your email address. You'll receive a password
                    reset link within a few minutes. If you don't see the email,
                    check your spam folder.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#accountTwo"
                  >
                    Update account information
                  </button>
                </h2>
                <div
                  id="accountTwo"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionAccount"
                >
                  <div class="accordion-body">
                    You can update your account information by logging in and
                    going to "Account Settings." Here you can change your name,
                    email address, phone number, and shipping addresses.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#accountThree"
                  >
                    Manage email preferences
                  </button>
                </h2>
                <div
                  id="accountThree"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionAccount"
                >
                  <div class="accordion-body">
                    You can manage your email preferences in your account
                    settings under "Communication Preferences." Choose which
                    types of emails you'd like to receive, including promotional
                    offers, order updates, and newsletters.
                  </div>
                </div>
              </div>
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#accountFour"
                  >
                    Delete my account
                  </button>
                </h2>
                <div
                  id="accountFour"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionAccount"
                >
                  <div class="accordion-body">
                    To delete your account, please contact our support team. For
                    security reasons, account deletion requests must be
                    verified. Note that deleting your account will remove your
                    order history and saved information permanently.
                  </div>
                </div>
              </div>
            </div>
          </div> -->
        </div>
      </div>
    </section>

    <!-- Support Ticket -->
    <section class="py-5">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="card border-0 shadow">
              <div class="card-body p-4 p-md-5">
                <h2 class="text-center mb-4">Submit a Support Ticket</h2>
                <p class="text-center text-muted mb-4">
                  Can't find what you're looking for? Submit a ticket and our
                  support team will get back to you.
                </p>
                <form id="supportForm">
                  <div class="row g-3">
                    <div class="col-md-6">
                      <label for="name" class="form-label">Your Name</label>
                      <input
                        type="text"
                        class="form-control"
                        id="name"
                        name="from_name"
                        required
                      />
                    </div>
                    <div class="col-md-6">
                      <label for="email" class="form-label"
                        >Email Address</label
                      >
                      <input
                        type="email"
                        class="form-control"
                        id="email"
                        name="from_email"
                        required
                      />
                    </div>
                    <div class="col-md-6">
                      <label for="orderNumber" class="form-label"
                        >Order Number (if applicable)</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="orderNumber"
                        name="order_number"
                      />
                    </div>
                    <div class="col-md-6">
                      <label for="issueType" class="form-label"
                        >Issue Type</label
                      >
                      <select
                        class="form-select"
                        id="issueType"
                        name="issue_type"
                        required
                      >
                        <option value="" selected disabled>
                          Select an issue type
                        </option>
                        <option value="Order Issue">Order Issue</option>
                        <option value="Return/Refund">Return/Refund</option>
                        <option value="Payment Problem">Payment Problem</option>
                        <option value="Account Help">Account Help</option>
                        <option value="Product Question">
                          Product Question
                        </option>
                        <option value="Other">Other</option>
                      </select>
                    </div>
                    <div class="col-12">
                      <label for="subject" class="form-label">Subject</label>
                      <input
                        type="text"
                        class="form-control"
                        id="subject"
                        name="subject"
                        required
                      />
                    </div>
                    <div class="col-12">
                      <label for="message" class="form-label">Message</label>
                      <textarea
                        class="form-control"
                        id="message"
                        name="message"
                        rows="5"
                        required
                      ></textarea>
                    </div>
                    <div class="col-12 text-center">
                      <button
                        type="submit"
                        class="btn btn-primary btn-lg px-5"
                        id="submitBtn"
                      >
                        Submit Ticket
                        <i class="bi bi-send ms-2"></i>
                      </button>
                      <button
                        class="btn btn-primary btn-lg px-5 d-none"
                        type="button"
                        disabled
                        id="loadingBtn"
                      >
                        <span
                          class="spinner-border spinner-border-sm me-2"
                          role="status"
                          aria-hidden="true"
                        ></span>
                        Submitting...
                      </button>
                    </div>
                  </div>
                </form>
                <div id="formSuccess" class="alert alert-success mt-4 d-none">
                  Thank you for submitting your support ticket! We'll get back
                  to you as soon as possible.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Cart Components Section -->
    <div id="cartComponentsSection"></div>

    <!-- Footer Section -->
    <div id="footerSection"></div>

    <script src="../customElements/bottom-scripts.js"></script>
    <custom-bottom></custom-bottom>

    <!-- Performance Optimization -->
    <script src="../js/performance.js"></script>

    <!-- Custom JS -->
    <script src="../js/globalState.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="../js/supabase-config.js"></script>
    <script src="../js/business-data.js"></script>
    <script src="../js/form-utils.js"></script>
    <script src="../js/store-functions.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/shared-store.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Wait for sections to load
        document.addEventListener("sectionLoaded", function (e) {
          if (e.detail.id === "headerSection") {
            // Add active class to the About nav link
            document.querySelectorAll(".nav-link").forEach((link) => {
              if (link.getAttribute("href").includes("support")) {
                link.classList.add("active");
              }
            });
          }
        });

        // Handle form submission with EmailJS
        document
          .getElementById("supportForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            // Show loading state
            FormUtils.toggleLoadingState("submitBtn", "loadingBtn", true);

            // Get and sanitize form data
            const formData = {
              name: document.getElementById("name").value,
              email: document.getElementById("email").value,
              orderNumber: document.getElementById("orderNumber").value,
              issueType: document.getElementById("issueType").value,
              subject: document.getElementById("subject").value,
              message: document.getElementById("message").value,
            };

            const sanitizedData = FormUtils.sanitizeFormData(formData);

            // Validate email
            if (!FormUtils.isValidEmail(sanitizedData.email)) {
              alert("Please enter a valid email address");
              return;
            }

            // Load EmailJS dynamically
            var script = document.createElement("script");
            script.src =
              "https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js";
            script.onload = function () {
              // Initialize EmailJS
              emailjs.init("L7o6hZUmFJQ_Jbqu0");

              // Send the email
              emailjs
                .send("service_s481rtv", "template_771ecr6", {
                  to_email:
                    window.globalStore?.state?.Email ||
                    "pabloandreychacon@gmail.com",
                  from_name: sanitizedData.name,
                  from_email: sanitizedData.email,
                  subject: `Support Ticket: ${sanitizedData.issueType} - ${sanitizedData.subject}`,
                  message: `Subject: ${sanitizedData.subject}\nFrom: ${
                    sanitizedData.email
                  }\nOrder Number: ${
                    sanitizedData.orderNumber || "N/A"
                  }\nIssue Type: ${sanitizedData.issueType}\n\n${
                    sanitizedData.message
                  }`,
                })
                .then(
                  function () {
                    // Show success message
                    document
                      .getElementById("formSuccess")
                      .classList.remove("d-none");
                    document.getElementById("supportForm").reset();
                    FormUtils.toggleLoadingState(
                      "submitBtn",
                      "loadingBtn",
                      false
                    );
                  },
                  function (error) {
                    console.error("Email sending failed:", error);
                    alert(
                      "Failed to submit support ticket. Please try again later."
                    );
                    FormUtils.toggleLoadingState(
                      "submitBtn",
                      "loadingBtn",
                      false
                    );
                  }
                );
            };
            document.head.appendChild(script);
          });

        // Update business contact info when data is ready
        function updateBusinessContactInfo() {
          const businessPhone = window.globalStore?.state?.Phone || "+1 (800) 123-4567";
          const businessEmail = window.globalStore?.state?.Email || "support@postore.com";
          
          // Update phone
          const phoneElement = document.getElementById("business-phone");
          if (phoneElement) {
            phoneElement.textContent = businessPhone;
            phoneElement.href = `tel:${businessPhone.replace(/\D/g, "")}`;
          }
          
          // Update email
          const emailElement = document.getElementById("business-email");
          if (emailElement) {
            emailElement.textContent = businessEmail;
          }
        }
        
        // Listen for business data loaded event
        window.addEventListener('businessDataLoaded', updateBusinessContactInfo);
        
        // Also check if business data is already loaded
        if (window.businessDataReady && window.globalStore?.state) {
          updateBusinessContactInfo();
        }
      });
    </script>
  </body>
</html>
