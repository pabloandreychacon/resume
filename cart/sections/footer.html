<!-- Footer -->
<footer class="bg-dark text-white py-5">
  <div class="container">
    <div class="row">
      <div class="col-md-5 mb-4">
        <h5 class="fw-bold mb-3 footer-title">
          <i class="bi bi-shop me-2"></i>
        </h5>
        <p class="mb-3" data-i18n="trusted_destination">
          Your trusted destination for premium products and exceptional shopping
          experience.
        </p>
        <div class="social-icons mb-3">
          <a
            href="https://facebook.com"
            target="_blank"
            class="text-white me-3"
            aria-label="Facebook"
          >
            <i class="bi bi-facebook fs-4"></i>
          </a>
          <a
            href="https://instagram.com"
            target="_blank"
            class="text-white me-3"
            aria-label="Instagram"
          >
            <i class="bi bi-instagram fs-4"></i>
          </a>
          <a
            href="https://twitter.com"
            target="_blank"
            class="text-white me-3"
            aria-label="Twitter"
          >
            <i class="bi bi-twitter fs-4"></i>
          </a>
          <a
            href="https://youtube.com"
            target="_blank"
            class="text-white me-3"
            aria-label="YouTube"
          >
            <i class="bi bi-youtube fs-4"></i>
          </a>
          <a
            href="https://pinterest.com"
            target="_blank"
            class="text-white"
            aria-label="Pinterest"
          >
            <i class="bi bi-pinterest fs-4"></i>
          </a>
        </div>
      </div>
      <div class="col-md-3 mb-4">
        <h6 class="fw-bold mb-3" data-i18n="quick_links">Quick Links</h6>
        <ul class="list-unstyled">
          <li>
            <a
              href="pages/about.html"
              class="text-decoration-none"
              data-i18n="about_us"
              >About Us</a
            >
          </li>
          <li>
            <a
              href="pages/contact.html"
              class="text-decoration-none"
              data-i18n="contact"
              >Contact</a
            >
          </li>
          <li>
            <a
              href="pages/faq.html"
              class="text-decoration-none"
              data-i18n="faqs"
              >FAQ</a
            >
          </li>
          <li>
            <a
              href="pages/support.html"
              class="text-decoration-none"
              data-i18n="support"
              >Support</a
            >
          </li>
        </ul>
      </div>

      <div class="col-md-4 mb-4">
        <h6 class="fw-bold mb-3" data-i18n="newsletter">Newsletter</h6>
        <p class="" data-i18n="newsletter_description">
          Subscribe to get updates on new products and offers.
        </p>
        <form id="newsletterForm" class="needs-validation" novalidate>
          <input
            type="hidden"
            name="subject"
            value="New Newsletter Subscription"
          />
          <div class="input-group">
            <input
              type="email"
              class="form-control"
              placeholder="Enter your email"
              id="newsletterEmail"
              name="replyTo"
              required
              data-i18n="enter_email"
            />
            <button class="btn btn-primary" type="submit" data-i18n="subscribe">
              Subscribe
            </button>
          </div>
          <div class="invalid-feedback">
            Please enter a valid email address.
          </div>
          <div class="form-text text-light mt-2 d-none" id="newsletterSuccess">
            Thank you for subscribing!
          </div>
          <div class="form-text text-danger mt-2 d-none" id="newsletterError">
            There was an error. Please try again.
          </div>
        </form>
        <script>
          document
            .getElementById("newsletterForm")
            .addEventListener("submit", function (event) {
              event.preventDefault();

              if (!this.checkValidity()) {
                this.classList.add("was-validated");
                return;
              }

              var email = FormUtils.sanitizeInput(
                document.getElementById("newsletterEmail").value
              );

              // Validate email
              if (!FormUtils.isValidEmail(email)) {
                document
                  .getElementById("newsletterError")
                  .classList.remove("d-none");
                document
                  .getElementById("newsletterSuccess")
                  .classList.add("d-none");
                return;
              }

              // Mostrar mensaje de éxito
              document
                .getElementById("newsletterSuccess")
                .classList.remove("d-none");
              document
                .getElementById("newsletterError")
                .classList.add("d-none");

              // Cargar EmailJS dinámicamente
              var script = document.createElement("script");
              script.src =
                "https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js";
              script.onload = function () {
                // Inicializar EmailJS y enviar el correo
                emailjs.init("L7o6hZUmFJQ_Jbqu0");

                emailjs
                  .send("service_s481rtv", "template_771ecr6", {
                    to_email:
                      window.globalStore.state.Email ||
                      "pabloandreychacon@gmail.com",
                    from_email: email,
                    message: "Nueva suscripción al newsletter de: " + email,
                  })
                  .then(
                    function () {
                      console.log("Email enviado correctamente!");
                    },
                    function (error) {
                      console.error("Error al enviar email:", error);
                      document
                        .getElementById("newsletterError")
                        .classList.remove("d-none");
                      document
                        .getElementById("newsletterSuccess")
                        .classList.add("d-none");
                    }
                  );
              };

              script.onerror = function () {
                console.error("Error al cargar EmailJS");
                document
                  .getElementById("newsletterError")
                  .classList.remove("d-none");
                document
                  .getElementById("newsletterSuccess")
                  .classList.add("d-none");
              };

              document.body.appendChild(script);
              this.reset();
            });
        </script>
      </div>
    </div>
    <!-- Disclaimer row -->
    <div class="row">
      <div class="col text-center">
        <p class="mb-0">
          <small class="text-white" data-i18n="footer_disclaimer">
            Disclaimer: Postore Online is free to use, we don't charge anything.
            If you find any problem with your payments and orders, please
            contact the client store support directly. We are not responsible
            for any issues related to payments or orders.
          </small>
        </p>
      </div>
    </div>
    <hr class="my-4" />
    <div class="text-center">
      <p class="mb-0">
        &copy; <span id="year"></span> POStore.
        <span data-i18n="all_rights_reserved">All rights reserved.</span>
      </p>
      <script>
        document.querySelector("#year").textContent = new Date().getFullYear();
      </script>
    </div>
  </div>
</footer>

<script>
  // Set business name after business data is loaded
  function updateFooterBusinessName() {
    const businessName = window.globalStore?.state?.BusinessName || "POStore";
    const titleElement = document.querySelector(".footer-title i");
    if (titleElement) {
      titleElement.parentElement.innerHTML = `<img class="postore-logo me-2" src="../assets/img/point-of-sale-icon-10649.png" alt="POStore" class="img-fluid" style="width: 30px; height: 30px;">${businessName}</img>`;
    }
  }

  // Listen for business data loaded event
  window.addEventListener("businessDataLoaded", updateFooterBusinessName);
</script>
